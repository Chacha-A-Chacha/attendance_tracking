{% extends "enrollment_base.html" %}

{% block title %}Find Your Application - Programming Course{% endblock %}

{% block content %}
<div class="space-y-12">
    <!-- Search Header -->
    <div class="text-center">
        <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-blue-100">
            <svg viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-blue-600">
                <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
            </svg>
        </div>
        <h1 class="mt-6 text-3xl/9 font-bold tracking-tight text-gray-900">Find Your Application</h1>
        <p class="mt-2 text-base/7 text-gray-600">Search for your enrollment application using your email address or application number.</p>
    </div>

    <!-- Form Validation Errors -->
    {% if form.errors %}
        <div class="rounded-md bg-red-50 p-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-red-400">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm/6 font-medium text-red-800">Please correct the following:</h3>
                    <div class="mt-2 text-sm/6 text-red-700">
                        <ul class="list-disc list-inside space-y-1">
                            {% for field_name, errors in form.errors.items() %}
                                {% for error in errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

    <!-- Search Form -->
    <div class="border-b border-gray-900/10 pb-12">
        <h2 class="text-base/7 font-semibold text-gray-900">Search Application</h2>
        <p class="mt-1 text-sm/6 text-gray-600">Enter your email address or application number to access your application dashboard.</p>

        <form method="POST"
              action="{{ url_for('enrollment.search_application') }}"
              x-data="searchForm()"
              @submit="handleSubmit"
              class="mt-10">

            {{ form.hidden_tag() }}

            <div class="grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-3">
                <div class="sm:col-span-2">
                    <label for="{{ form.search_term.id }}" class="block text-sm/6 font-medium text-gray-900">
                        {{ form.search_term.label.text }} <span class="text-red-500">*</span>
                    </label>
                    <div class="mt-2">
                        {{ form.search_term(class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600 sm:text-sm/6",
                            autocomplete="email") }}
                    </div>
                    {% if form.search_term.errors %}
                        <p class="mt-2 text-sm/6 text-red-600">{{ form.search_term.errors[0] }}</p>
                    {% endif %}
                </div>

                <div class="flex items-end">
                    <button type="submit"
                            class="w-full rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-blue-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed"
                            :disabled="searching">
                        <span x-show="!searching" class="flex items-center justify-center">
                            <svg viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4 mr-2">
                                <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                            </svg>
                            Search
                        </span>
                        <span x-show="searching" class="flex items-center justify-center">
                            <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            Searching...
                        </span>
                    </button>
                </div>
            </div>
        </form>
    </div>

    <!-- Search Instructions -->
    <div class="border-b border-gray-900/10 pb-12">
        <h2 class="text-base/7 font-semibold text-gray-900">Search Options</h2>
        <p class="mt-1 text-sm/6 text-gray-600">You can search using either of these methods:</p>

        <div class="mt-10 grid grid-cols-1 gap-6 sm:grid-cols-2">
            <div class="rounded-lg border border-gray-200 p-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-blue-600">
                            <path d="M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"></path>
                            <path d="M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-base/7 font-medium text-gray-900">Email Address</h3>
                        <p class="mt-1 text-sm/6 text-gray-500">Use the email address you provided during application</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p class="text-sm/6 text-gray-600">
                        <strong>Example:</strong> <code class="rounded bg-gray-100 px-1 py-0.5 text-xs">your.email@example.com</code>
                    </p>
                </div>
            </div>

            <div class="rounded-lg border border-gray-200 p-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 text-blue-600">
                            <path fill-rule="evenodd" d="M4.5 2A1.5 1.5 0 003 3.5v13A1.5 1.5 0 004.5 18h11a1.5 1.5 0 001.5-1.5V7.621a1.5 1.5 0 00-.44-1.06L11.44 1.44A1.5 1.5 0 0010.378 1H4.5zm2.25 8.5a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zm0 3a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-base/7 font-medium text-gray-900">Application Number</h3>
                        <p class="mt-1 text-sm/6 text-gray-500">Use the application number from your confirmation</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p class="text-sm/6 text-gray-600">
                        <strong>Example:</strong> <code class="rounded bg-gray-100 px-1 py-0.5 text-xs">APP202500001</code>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Information -->
    <div>
        <h2 class="text-base/7 font-semibold text-gray-900">Need Help?</h2>
        <p class="mt-1 text-sm/6 text-gray-600">If you're having trouble finding your application, try these suggestions:</p>

        <div class="mt-6 space-y-6">
            <div class="rounded-md bg-blue-50 p-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-blue-400">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm/6 font-medium text-blue-800">Can't Find Your Application?</h3>
                        <div class="mt-2 text-sm/6 text-blue-700">
                            <ul class="list-disc list-inside space-y-1">
                                <li>Check your email for the application confirmation with your application number</li>
                                <li>Make sure you're using the exact email address used during application</li>
                                <li>Try searching with different email addresses if you have multiple</li>
                                <li>Application numbers start with "APP" followed by the year and sequence number</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="rounded-md bg-gray-50 p-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-gray-400">
                            <path fill-rule="evenodd" d="M2 3.5A1.5 1.5 0 013.5 2h1.148a1.5 1.5 0 011.465 1.175l.716 3.223a1.5 1.5 0 01-1.052 1.767l-.933.267c-.41.117-.643.555-.48.95a11.542 11.542 0 006.254 6.254c.395.163.833-.07.95-.48l.267-.933a1.5 1.5 0 011.767-1.052l3.223.716A1.5 1.5 0 0118 15.352V16.5a1.5 1.5 0 01-1.5 1.5H15c-1.149 0-2.263-.15-3.326-.43A13.022 13.022 0 012.43 8.326 13.019 13.019 0 012 5V3.5z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm/6 font-medium text-gray-800">Still Need Help?</h3>
                        <div class="mt-2 text-sm/6 text-gray-700">
                            <p>Contact our support team at <a href="mailto:{{ config.CONTACT_EMAIL or 'info@jaribu.org' }}" class="font-medium text-blue-600 hover:text-blue-500">{{ config.CONTACT_EMAIL or 'info@jaribu.org' }}</a> with your name and the email address you used to apply.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Application Option -->
    <div class="text-center border-t border-gray-900/10 pt-12">
        <h3 class="text-base/7 font-semibold text-gray-900">Don't have an application yet?</h3>
        <p class="mt-2 text-sm/6 text-gray-600">Start your enrollment process by submitting a new application.</p>
        <div class="mt-6">
            <a href="{{ url_for('enrollment.create_enrollment') }}"
               class="rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-blue-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600">
                Submit New Application
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Search form specific Alpine.js component
function searchForm() {
    return {
        searching: false,

        handleSubmit(event) {
            this.searching = true;
            // Form will submit normally, this just handles UI state
        }
    }
}
</script>
{% endblock %}
